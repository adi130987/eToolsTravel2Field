
<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../styles/shared-styles.html">

<dom-module id="list-header">

  <style include="shared-styles travel-list">
    :host {
      display: block;
      padding: 0;
      margin: 0;
    }
    .headingrow {
      width: 100%;
      box-shadow: inset 0 -1px 0 rgba(0,0,0,0.3);
    }
    .localheadings {
      display: block;
      box-sizing: border-box;
      float: left;
      font-weight: 500;
      cursor: pointer; /*Chrome bug, works in safari, */
    }
    .heading {
      line-height: 56px;
      font-size: 12px;
    }
    .localheadings iron-icon {
      width: 16px;
      height: 16px;
      color: rgba(0,0,0,0.54);
    }
    .localheadings:hover iron-icon {
      color: rgba(0,0,0,0.86);
    }
  </style>

  <template>
    <div class="headingrow clearfix layout horizontal">
      <div class="w60">
        <span class="textsec heading">60a</span>
      </div>
      <template is="dom-repeat" items="[[metaData]]" observe="item.down item.up">
        <div on-click="_clickOnLabel" class$="localheadings [[_sizeClassGenerator(item)]]">
          <span class="textsec heading">[[item.label]]</span>

          <iron-icon
            icon="icons:arrow-downward"
            hidden$="{{item.down}}">
          </iron-icon>

          <iron-icon
            icon="icons:arrow-upward"
            hidden$="{{item.up}}">
          </iron-icon>

        </div>
      </template>
    </div>

  </template>

  <script>
    Polymer({
      is: 'list-header',
      properties: {
        data: {
          type: Array,
          value: []
        },
        orderObj: {
          type: Object,
          notify: true
        },
        metaData: {
          type: Array,
          computed: '_getMetaData(data, orderObj)',
          notify: true
        }
      },
      _sizeClassGenerator: function(item) {
        return 'w' + item.size;
      },
      _clickOnLabel: function(event) {

        var newOrderBy = event.model.item.label;
        if (newOrderBy === "Duplicate") { return; } // Don't reorder by passive

        if (newOrderBy === this.orderObj.orderedBy) {
          this.set('orderObj', {
            orderedBy: newOrderBy,
            reverse: !this.orderObj.reverse
          });
        } else {
          this.set('orderObj', {
            orderedBy: newOrderBy,
            reverse: false
          });
        }
      },

      _getMetaData: function(data, orderObj) {
        // console.log('Computing metadata fn. called');
        // console.log(data, orderObj);

        var metaData = data.map(function(el) {
          el.up = !(orderObj.orderedBy === el.label && !orderObj.reverse);
          el.down = !(orderObj.orderedBy === el.label && orderObj.reverse);
          return el;
        });

        // console.log('metaData: ', metaData);
        return metaData;
      },

    });
  </script>
</dom-module>
