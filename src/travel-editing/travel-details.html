

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/paper-input/paper-textarea.html">




<link rel="import" href="../shared-styles.html">
<link rel="import" href="./repeatable-field-set.html">
<link rel="import" href="./searchable-selection.html">
<link rel="import" href="./datepicker-input.html">

<dom-module id="travel-details">
    <template>
        <style include="shared-styles iron-flex iron-flex-alignment iron-flex-factors">
            :host {
                display: block;
                width: 100%;
            }
            *[hidden] {
                display: none;
            }
            .custom-margin {
                --paper-input-container: {
                    width: calc(100% - 24px);
                    height: auto;
                    margin-left: 12px;
                    margin-bottom: 12px;
                };
                --paper-checkbox-margin: 12px;
            }
            .wide {
                width:100%;
            }

        </style>

        <repeatable-field-set hide-plus="true" title="Travel Plan" >
            <div class="wide field-1" >
                <div class="layout horizontal">
                    <paper-checkbox class="flex-3 custom-margin">TA required? </paper-checkbox>
                    <paper-checkbox class="flex-3 custom-margin">International travel? </paper-checkbox>
                    <span class="flex-3">Reference #: </span>
                    <div class="flex-3"></div>
                </div>
                <div class="layout horizontal">
                    <searchable-selection class="flex-3" options="[[structure.traveler]]" label="Traveler" value="{{baseDetails.traveler}}"></searchable-selection>
                    <searchable-selection class="flex-3" options="[[structure.supervisor]]" label="Supervisor" value="{{baseDetails.supervisor}}"></searchable-selection>
                    <searchable-selection class="flex-3" options="[[structure.office]]" label="Office" value="{{baseDetails.office}}"></searchable-selection>
                    <searchable-selection class="flex-3" options="[[structure.section]]" label="Section" value="{{baseDetails.section}}"></searchable-selection>
                </div>
                <div class="layout horizontal">
                    <datepicker-input class="flex-3" label="Start Date" value="{{baseDetails.startDate}}"></datepicker-input>
                    <datepicker-input class="flex-3" label="End Date " value="{{baseDetails.endDate}}"></datepicker-input>
                    <paper-input class="flex-3 custom-margin" label="Estimated travel cost" value="{{baseDetails.estimatedTravelCost}}"></paper-input>
                    <searchable-selection class="flex-3" options="[[structure.currency]]"  label="Currency" value="{{baseDetails.currency}}"></searchable-selection>
                </div>
                <div class="layout horizontal">
                    <searchable-selection class="flex-6" options="[[structure.travel]]" multi label="Mode of travel" value="{{baseDetails.modeOfTravel}}"></searchable-selection>
                    <div class="flex-6"></div>
                </div>
                <div class="layout horizontal">
                    <paper-textarea  label= "Purpose of travel" class="flex-12 custom-margin" required char-counter maxlength="500" value="{{baseDetails.purpose}}"></paper-textarea>
                </div>
            </div>
        </repeatable-field-set>

        <repeatable-field-set title="Travel Activities" model="{{data.activities}}" id-attribute="id" allow-copy>

            <template is="dom-repeat" items="{{data.activities}}">
                <div class$="wide field-{{item.id}}">
                    <div class="layout horizontal">
                        <searchable-selection class="flex-4" options="[[structure.traveler]]" label="Travel Type" value="{{item.travelerType}}"></searchable-selection>
                        <searchable-selection class="flex-4" options="[[structure.traveler]]" label="Partner"  value="{{item.partner}}"></searchable-selection>
                        <searchable-selection class="flex-4" options="[[structure.traveler]]" label="Partnership"  value="{{item.partnership}}"></searchable-selection>
                    </div>
                    <div class="layout horizontal">
                        <searchable-selection class="flex-4" options="[[structure.traveler]]" label="Result/Activities to be monitored"  value="{{item.activitiesToBeMonitored}}"></searchable-selection>
                        <searchable-selection class="flex-8" options="[[structure.supervisor]]" label="Travel locations" multi  value="{{item.modeOfTravel}}"></searchable-selection>
                    </div>
                    <div class="layout horizontal">
                        <datepicker-input class="flex-4" label="When?"  value="{{item.when}}"></datepicker-input>
                        <paper-checkbox class="flex-8 custom-margin self-end">I am a Primary Traveler </paper-checkbox>
                    </div>
                </div>
            </template>

        </repeatable-field-set>

        <repeatable-field-set title="Itinerary" model="{{data.itinerary}}" id-attribute="id" show-counter>
            <template is="dom-repeat" items="{{data.itinerary}}">
                <div class$="wide field-{{item.id}}">
                    <div class="layout horizontal">
                        <searchable-selection class="flex-4" options="[[structure.traveler]]" label="From" value="{{item.from}}"></searchable-selection>
                        <searchable-selection class="flex-4" options="[[structure.traveler]]" label="To" value="{{item.to}}"></searchable-selection>
                        <searchable-selection class="flex-4" options="[[structure.traveler]]" label="DSA Region" value="{{item.dsaRegion}}"></searchable-selection>
                    </div>

                    <div class="layout horizontal">
                        <datepicker-input class="flex-4" label="Departing"  value="{{item.departing}}"></datepicker-input>
                        <datepicker-input class="flex-4" label="Arriving"  value="{{item.arriving}}"></datepicker-input>
                        <searchable-selection class="flex-2" options="[[structure.traveler]]" label="Mode of  travel" value="{{item.modeOfTravel}}"></searchable-selection>
                        <paper-checkbox class="flex-2 custom-margin self-end">Overnight travel? </paper-checkbox>
                    </div>
                </div>
            </template>
        </repeatable-field-set>


        <repeatable-field-set title="Deductions" model="[1]" hide-plus>
            Deductions placeholder
        </repeatable-field-set>

        <repeatable-field-set title="Expenses" model="{{data.expenses}}" id-attribute="id" show-counter>
            <template is="dom-repeat" items="{{data.expenses}}">
                <div class$="wide field-{{item.id}}">
                    <div class="layout horizontal">
                        <searchable-selection class="flex-3" options="[[structure.traveler]]" label="Travel expense type" value="{{item.expenseType}}"></searchable-selection>
                        <paper-input class="flex-3 custom-margin"  label="Amount" type="number"  value="{{item.amount}}"></paper-input>
                        <searchable-selection class="flex-3" options="[[structure.traveler]]" label="Document currency" value="{{item.documentCurrency}}"></searchable-selection>
                        <searchable-selection class="flex-3" options="[[structure.traveler]]" label="Accounting currency" value="{{item.accountingCurrency}}"></searchable-selection>
                    </div>
                </div>
            </template>
        </repeatable-field-set>

        <repeatable-field-set title="Cost Assignment" model="{{data.costAssignment}}" id-attribute="id" show-counter>
            <template is="dom-repeat" items="{{data.costAssignment}}">
                <div class$="wide field-{{item.id}}">
                    <div class="layout horizontal">
                        <searchable-selection class="flex-6" options="[[structure.traveler]]" label="WBS" value="{{item.wbs}}"></searchable-selection>
                        <paper-input class="flex-2 custom-margin"  label="Share(%)" type="number"  value="{{item.share}}"></paper-input>
                        <paper-input class="flex-2 custom-margin"  label="Grant(%)" type="number"  value="{{item.grant}}"></paper-input>
                        <searchable-selection class="flex-2" options="[[structure.traveler]]" label="Fund" value="{{item.fund}}"></searchable-selection>
                    </div>
                </div>
            </template>
        </repeatable-field-set>


    </template>

    <script>
        Polymer({
            is: 'travel-details',
            properties: {
                data: {
                    type: Object,
                    notify: true,
                    value: {
                        baseDetails: {},
                        activities: [{id: 1}, {id: 2}],
                        itinerary: [{id: 1}],
                        expenses: [{id: 1}],
                        costAssignment: [{id: 1}]
                    }
                },
                structure: {
                    type: Object,
                    value: {}
                }
            },
        });
    </script>
</dom-module>
